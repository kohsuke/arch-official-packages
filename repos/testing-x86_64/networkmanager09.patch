From 76001a795ed8f88d1aee317d71b7ae76384549d5 Mon Sep 17 00:00:00 2001
From: Andrea Scarpino <andrea@archlinux.org>
Date: Tue, 12 Apr 2011 11:22:06 +0200
Subject: [PATCH] build with Network Manager 0.9

---
 backends/NetworkManager/nmdbussettingsservice.cpp |    3 +++
 backends/NetworkManager/settings/gsmdbus.cpp      |    4 ++--
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/backends/NetworkManager/nmdbussettingsservice.cpp b/backends/NetworkManager/nmdbussettingsservice.cpp
index 65e654e..035e7b0 100644
--- a/backends/NetworkManager/nmdbussettingsservice.cpp
+++ b/backends/NetworkManager/nmdbussettingsservice.cpp
@@ -57,6 +57,9 @@ public:
     QHash<QUuid, QDBusObjectPath> uuidToPath;
 };
 
+#define NM_DBUS_SERVICE_USER_SETTINGS     "org.freedesktop.NetworkManagerUserSettings"
+#define NM_DBUS_SERVICE_SYSTEM_SETTINGS   "org.freedesktop.NetworkManagerSystemSettings"
+
 const QString NMDBusSettingsService::SERVICE_USER_SETTINGS = QLatin1String(NM_DBUS_SERVICE_USER_SETTINGS);
 const QString NMDBusSettingsService::SERVICE_SYSTEM_SETTINGS = QLatin1String(NM_DBUS_SERVICE_SYSTEM_SETTINGS);
 
diff --git a/backends/NetworkManager/settings/gsmdbus.cpp b/backends/NetworkManager/settings/gsmdbus.cpp
index 9912df6..eedf1ea 100644
--- a/backends/NetworkManager/settings/gsmdbus.cpp
+++ b/backends/NetworkManager/settings/gsmdbus.cpp
@@ -35,7 +35,7 @@ void GsmDbus::fromMap(const QVariantMap & map)
   if (map.contains(QLatin1String(NM_SETTING_GSM_NETWORK_TYPE))) {
     setting->setNetworktype(map.value(QLatin1String(NM_SETTING_GSM_NETWORK_TYPE)).value<int>());
   } else {
-      setting->setNetworktype(NM_GSM_NETWORK_ANY);
+      setting->setNetworktype(NM_SETTING_GSM_NETWORK_TYPE_ANY);
   }
   if (map.contains("band")) {
     setting->setBand(map.value("band").value<int>());
@@ -62,7 +62,7 @@ QVariantMap GsmDbus::toMap()
       map.insert("apn", setting->apn());
   if (!setting->networkid().isEmpty())
       map.insert(QLatin1String(NM_SETTING_GSM_NETWORK_ID), setting->networkid());
-  if (setting->networktype() != NM_GSM_NETWORK_ANY) {
+  if (setting->networktype() != NM_SETTING_GSM_NETWORK_TYPE_ANY) {
       map.insert(QLatin1String(NM_SETTING_GSM_NETWORK_TYPE), setting->networktype());
   }
 
-- 
1.7.4.4

