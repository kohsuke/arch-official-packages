# $Id$
# Maintainer: Eric BÃ©langer <eric@archlinux.org>

pkgname=foobillard++
pkgver=3.41beta
pkgrel=1
pkgdesc="An OpenGL billiard game"
arch=('i686' 'x86_64')
url="http://foobillardplus.sourceforge.net/"
license=('GPL2')
depends=('bzip2' 'freetype2' 'libpng' 'mesa' 'sdl_net')
replaces=('foobillard')
source=(http://downloads.sourceforge.net/foobillardplus/foobillardplus-${pkgver}.tar.gz)
sha1sums=('41d6db473557386ffeacd98b9a2ee26198e42c6a')

build() {
  cd "${srcdir}/foobillardplus-${pkgver}"
  sed -i 's|$prefix/foobillardplus|$prefix|' configure
  sed -i 's|$prefix/data|$prefix/share/foobillardplus|' configure
  sed -i 's|"/data"|"/share/foobillardplus"|' src/language.c
  sed -i 's|/opt/foobillardplus/bin/||' foobillardplus.desktop
  sed -i 's|/opt/foobillardplus/||' foobillardplus.desktop
  ./configure --prefix=/usr
  make
}

package() {
  cd "${srcdir}/foobillardplus-${pkgver}"
  install -Dm755 src/foobillardplus "${pkgdir}/usr/bin/foobillardplus"
  install -d "${pkgdir}/usr/share/foobillardplus"
  cp -R data/* "${pkgdir}/usr/share/foobillardplus"
  install -Dm644 foobillardplus.desktop "${pkgdir}/usr/share/applications/foobillardplus.desktop"
  install -Dm644 foobillardplus.png "${pkgdir}/usr/share/pixmaps/foobillardplus.png"
  install -Dm644 foobillardplus.xbm "${pkgdir}/usr/share/pixmaps/foobillardplus.xbm"
  find "${pkgdir}" -depth  -type d -name .svn -exec rm -rf  {} \;
}
