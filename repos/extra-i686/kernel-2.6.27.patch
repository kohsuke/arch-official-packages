--- intel-537EP_secure-2.60.80.0/coredrv/coredrv.c~	2008-10-11 15:12:11.000000000 +0000
+++ intel-537EP_secure-2.60.80.0/coredrv/coredrv.c	2008-10-11 15:12:11.000000000 +0000
@@ -52,6 +52,11 @@
 #include <linux/pm.h>
 #endif
 
+typedef int __bitwise pm_request_t;
+
+#define PM_SUSPEND     ((__force pm_request_t) 1)      /* enter D1-D3 */
+#define PM_RESUME      ((__force pm_request_t) 2)      /* enter D0 */
+
 #include "uart.h"
 #include "rts.h"
 #include "lock_lin.h"
--- intel-537EP_secure-2.60.80.0/coredrv/locks.c~	2008-10-11 15:23:05.000000000 +0000
+++ intel-537EP_secure-2.60.80.0/coredrv/locks.c	2008-10-11 15:23:05.000000000 +0000
@@ -39,7 +39,7 @@
 #include<linux/interrupt.h>
 #include<linux/irq.h>
 #include<linux/spinlock.h>
-#include<asm/semaphore.h>
+#include<linux/semaphore.h>
 #include"lock_lin.h"
 
 #if !defined(CONFIG_SMP)
--- intel-537EP_secure-2.60.80.0/coredrv/softserial.c~	2008-10-11 15:25:02.000000000 +0000
+++ intel-537EP_secure-2.60.80.0/coredrv/softserial.c	2008-10-11 15:25:02.000000000 +0000
@@ -326,22 +326,7 @@
 #endif
    struct tty_struct* ptty;
 
-//   printk("softserial:softserial_backgound_event_handler()\n");
-   if(p_async_struct->tty == NULL) return;
-
-   ptty = p_async_struct->tty;
-
-   if(test_and_clear_bit(RS_EVENT_WRITE_WAKEUP, &p_async_struct->event))
-   {
-      if( (ptty->flags & (1 << TTY_DO_WRITE_WAKEUP)) &&
-          (ptty->ldisc.write_wakeup != NULL))
-      {
-//	 printk("ss_bg_eh:ldisc wakeup\n");
-         (ptty->ldisc.write_wakeup)(ptty);
-      }
-//      printk("ss_bg_eh: wakeup write_wait\n");
-      wake_up_interruptible(&ptty->write_wait);
-   }
+   tty_wakeup(ptty);
 }
 
 //=============================================================================
