# $Id$
# Maintainer: Andrea Scarpino <andrea@archlinux.org>

pkgbase=kdesdk-kate
pkgname=('kdebase-kwrite'
         'kdesdk-kate')
pkgver=4.7.4
pkgrel=1
arch=('i686' 'x86_64')
license=('GPL' 'LGPL' 'FDL')
makedepends=('kdelibs ''cmake' 'automoc4')
source=("http://download.kde.org/stable/${pkgver}/src/kate-${pkgver}.tar.bz2"
        'pkgbuild-syntax-highlight.patch')
sha1sums=('b808f01213e0e44607e8f2577f9d1b4f88e14388'
          'ab0c5d2a796b0f283154799add161c99f48ffcd5')

build() {
  cd "${srcdir}"/kate-${pkgver}
  patch -p1 -i "${srcdir}"/pkgbuild-syntax-highlight.patch

  cd "${srcdir}"
  mkdir build
  cd build
  cmake ../kate-${pkgver} \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DBUILD_KTEXTEDITOR=OFF
  make
}

package_kdebase-kwrite() {
  pkgdesc="Text Editor"
  depends=('kdebase-runtime')
  groups=('kde' 'kdebase')
  install='kdebase-kwrite.install'

  cd "${srcdir}"/build/kwrite
  make DESTDIR="${pkgdir}" install

  cd "${srcdir}"/build/part
  make DESTDIR="${pkgdir}" install

  cd "${srcdir}"/build/doc/kwrite
  make DESTDIR="${pkgdir}" install
}

package_kdesdk-kate() {
  pkgdesc="Advanced Text Editor"
  depends=('kdebase-kwrite')
  groups=('kde' 'kdesdk')
  install='kdesdk-kate.install'

  cd "${srcdir}"/build/kate
  make DESTDIR="${pkgdir}" install

  cd "${srcdir}"/build/doc/kate
  make DESTDIR="${pkgdir}" install
}
