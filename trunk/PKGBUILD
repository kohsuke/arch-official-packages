# $Id$
# Maintainer: Vesa Kaihlavirta <vesa@archlinux.org>
pkgname=ghc
pkgver=6.10.0.20080921
pkgrel=1
pkgdesc="A state-of-the-art, open source, compiler and interactive environment for Haskell."
arch=(i686 x86_64)
url="http://www.haskell.org/ghc/"
license="custom"
depends=(gmp libedit)
makedepends=(ghc happy perl)
source=("http://www.haskell.org/ghc/dist/stable/dist/ghc-6.10.0.20080921-src.tar.bz2" 
        "http://www.haskell.org/ghc/dist/stable/dist/ghc-6.10.0.20080921-src-extralibs.tar.bz2")
        
#source=("http://www.haskell.org/ghc/dist/$pkgver/$pkgname-$pkgver-src.tar.bz2" \
#    "http://www.haskell.org/ghc/dist/$pkgver/ghc-$pkgver-src-extralibs.tar.bz2"
#     build.mk)
#md5sums=('43108417594be7eba0918c459e871e40'
#         'd199c50814188fb77355d41058b8613c'
#         'dc94374c53aff2ab2d4f6cb75a349bb0'
#         '7a633e9fcc882d8874373481461acadb')

build() {
  #since this is a compiler, it needs itself to compile
  #installer automatically bootstraps itself, so this actually compiles twice
  #In order to compile, you need ghc installed on your system
  cd $startdir/src/$pkgname-$pkgver

  cd libraries/network && autoreconf || return 1
  cd - 

  cp $startdir/build.mk mk/build.mk

  ./configure --prefix=/usr 
  make -j2 || return 1
  make DESTDIR=$startdir/pkg install

  install -Dm644 LICENSE ${pkgdir}/usr/share/licenses/ghc/license
}
