# $Id$
# Maintainer: Ronald van Haren <ronald.archlinux.org>

pkgname=miro
pkgver=2.0.1
pkgrel=1
pkgdesc="The free and open source internet TV platform"
arch=('i686' 'x86_64')
url="http://www.getmiro.com"
license=('GPL2')
depends=('xine-lib>=1.1.16.1' 'boost>=1.37.0' 'gnome-python-extras>=2.19.1'
	 'dbus-python>=0.82.4' 'pyrex' 'xulrunner>=1.9.0.1' 'gtk2' 'nspr')
makedepends=('pkgconfig' 'pm-utils' 'qt3')
optdepends=('gstreamer0.10-python: gstreamer backend' 'gstreamer0.10: gstreamer backend')
install=miro.install
conflicts=('democracy')
replaces=('democracy')
provides=('democracy')
source=(http://ftp.osuosl.org/pub/pculture.org/miro/src/Miro-${pkgver}.tar.gz
	'miro-xine.patch')
md5sums=('9f180474f97f179e78d919e92b66e3e4'
         'e337440bd665e6c3c8da95f4b11dc447')

build() {
  cd ${srcdir}/Miro-${pkgver}/platform/gtk-x11
  python setup.py install --root=${pkgdir} || return 1
  
  # ugly hack to fix crashing when xine engine is used
  cd ${pkgdir}
  patch -Np0 -i ${srcdir}/miro-xine.patch || return 1
}
