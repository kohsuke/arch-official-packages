From: Lamarque V. Souza <lamarque@gmail.com>
Date: Sun, 17 Apr 2011 00:09:43 +0000
Subject: Fix compilation against NetworkManager-0.8.98.
X-Git-Url: http://quickgit.kde.org/?p=networkmanagement.git&amp;a=commitdiff&amp;h=e87ceccadc833e220f73d86352968655cedc0485
---
Fix compilation against NetworkManager-0.8.98.

BUG: 271101
---


--- a/backends/NetworkManager/nmdbussettingsservice.cpp
+++ b/backends/NetworkManager/nmdbussettingsservice.cpp
@@ -59,7 +59,7 @@ public:
     QHash<QUuid, QDBusObjectPath> uuidToPath;
 };
 
-const QString NMDBusSettingsService::SERVICE_USER_SETTINGS = QLatin1String(NM_DBUS_SERVICE_USER_SETTINGS);
+const QString NMDBusSettingsService::SERVICE_USER_SETTINGS = QLatin1String("org.freedesktop.NetworkManagerUserSettings");
 const QString NMDBusSettingsService::SERVICE_SYSTEM_SETTINGS = QLatin1String("org.freedesktop.NetworkManager");
 
 NMDBusSettingsService::NMDBusSettingsService(QObject * parent)

--- a/backends/NetworkManager/settings/gsmdbus.cpp
+++ b/backends/NetworkManager/settings/gsmdbus.cpp
@@ -35,7 +35,7 @@ void GsmDbus::fromMap(const QVariantMap 
   if (map.contains(QLatin1String(NM_SETTING_GSM_NETWORK_TYPE))) {
     setting->setNetworktype(map.value(QLatin1String(NM_SETTING_GSM_NETWORK_TYPE)).value<int>());
   } else {
-      setting->setNetworktype(NM_GSM_NETWORK_ANY);
+      setting->setNetworktype(NM_SETTING_GSM_NETWORK_TYPE_ANY);
   }
   if (map.contains("band")) {
     setting->setBand(map.value("band").value<int>());
@@ -62,7 +62,7 @@ QVariantMap GsmDbus::toMap()
       map.insert("apn", setting->apn());
   if (!setting->networkid().isEmpty())
       map.insert(QLatin1String(NM_SETTING_GSM_NETWORK_ID), setting->networkid());
-  if (setting->networktype() != NM_GSM_NETWORK_ANY) {
+  if (setting->networktype() != NM_SETTING_GSM_NETWORK_TYPE_ANY) {
       map.insert(QLatin1String(NM_SETTING_GSM_NETWORK_TYPE), setting->networktype());
   }
 

